# Revit addin switcher

**Revit addin switcher** — это вспомогательное приложение, предназначеное, в первую очередь для разработчиков, которым постоянно приходится переключаться между различными тестовыми версиями плагинов, а также для архитекторов, инженеров и BIM-менеджеров, работающих в Autodesk Revit. Оно позволяет легко включать, отключать и управлять плагинами Revit без необходимости редактирования реестра Windows или использования сложных обходных путей.

## Проблема

В Revit нет встроенного интерфейса для выборочного отключения плагинов. Если плагин вызывает сбои, конфликтует с другим ПО или просто не нужен для текущего проекта, пользователю приходится вручную переименовывать папки с плагинами или редактировать реестр Windows, что неудобно и может быть опасно для стабильности системы.

## Решение

Revit addin switcher предоставляет простой и интуитивно понятный графический интерфейс для управления плагинами:
*   **Просмотр:** Список всех установленных плагинов Revit.
*   **Включение/Отключение:** Включение или отключение любого плагина в один клик.
*   **Безопасность:** При отключении плагин не удаляется, а перемещается в резервную папку, что позволяет легко вернуть его обратно.

## Функциональность

*   **Автоматическое обнаружение плагинов:** Приложение автоматически находит установленные версии Revit и сканирует стандартные папки для загрузки плагинов (`Addins`).
*   **Простой интерфейс:** Четкий список плагинов с информацией о названии, версии и текущем статусе (Включен/Отключен).
*   **Групповые операции:** Возможность выбрать несколько плагинов для массового включения или отключения.
*   **Резервное копирование:** При отключении плагины перемещаются в специальную папку `Backup` внутри папки приложения, что гарантирует их сохранность.
*   **Поддержка нескольких версий Revit:** Управление плагинами для Revit 2020, 2021, 2022, 2023, 2024 и новее.

## Как это работает

1.  Приложение считывает список папок `Addins` из реестра Windows (пока устанавливается хардкодом) для каждой установленной версии Revit.
2.  Оно анализирует файлы `.addin` (которые являются manifest-файлами плагинов) в этих папках.
3.  В интерфейсе отображается список найденных плагинов.
4.  При отключении плагина приложение перемещает соответствующий файл `.addin` из оригинальной папки `Addins` в подпапку с `Неактивными` манифестами внутри папки приложения. Это позволяет Revit не видить манифест при запуске.
5.  При включении плагина файл `.addin` возвращается обратно в исходную папку `Addins`.
6.  При следующем запуске Revit он загружает только те плагины, manifest-файлы которых находятся в активных папках `Addins`.

## Установка и Использование

### Требования

*   Операционная система: Windows 10 или 11 (64-bit).
*   Установленная версия .NET Framework 4.8 или .NET 6/7/8 (в зависимости от версии приложения).
*   Установленный Autodesk Revit (2019+).

### Установка

1.  Скачайте последнюю версию приложения из раздела [Releases](https://github.com/VolocyNazad/revit.addin-switcher/releases).
2.  Распакуйте ZIP-архив в удобную для вас папку (например, `C:\Program Files\RevitPluginManager\`).
3.  Запустите файл `RevitPluginManager.exe`.

> **Важно:** Запускайте приложение от имени администратора, если у вас нет прав на запись в папки установки Revit. Это необходимо для возможности перемещения файлов плагинов.

### Использование

1.  **Запустите приложение.**
2.  **Просмотрите список плагинов:** В главном окне отобразится список всех обнаруженных плагинов. Столбец "Статус" показывает, включен плагин или отключен.
3.  **Управление плагинами:**
    *   Чтобы **отключить** плагин, выберите его в списке и нажмите кнопку "Отключить" (или используйте контекстное меню).
    *   Чтобы **включить** отключенный плагин, выберите его и нажмите кнопку "Включить".
4.  **Перезапустите Revit:** Чтобы изменения вступили в силу, закройте и снова откройте Revit.

## Скриншоты

## Разработка

Этот проект написан на C# с использованием WPF.

### Структура проекта

### Сборка из исходного кода

1.  Клонируйте репозиторий:
    ```bash
    git clone https://github.com/VolocyNazad/revit.addin-switcher.git
    ```
2.  Откройте решение `revit.addinSwitcher.sln` в Visual Studio 2022.
3.  Восстановите зависимости NuGet (если применимо).
4.  Соберите решение (Build -> Build Solution). Важно, чтобы активная конфигурация была 'Release'.

## Вклад в проект

Мы приветствуем вклады в развитие проекта! Пожалуйста, не стесняйтесь создавать Pull Request'ы или открывать Issue для сообщения об ошибках и предложения новых функций.

## Лицензия

Этот проект распространяется под лицензией MIT. Подробнее см. в файле [LICENSE](LICENSE).

## Заявление об ограничении ответственности

Это приложение не является официальным продуктом Autodesk. Используйте его на свой страх и риск. Авторы не несут ответственности за любые потери данных или проблемы, возникшие в результате его использования. Всегда рекомендуется создавать резервные копии критически важных данных перед внесением изменений в систему.
